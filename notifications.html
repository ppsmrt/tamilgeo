<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TamilGeo - Notifications</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <style>
    .bottom-nav {
      backdrop-filter: blur(15px);
      background: linear-gradient(90deg, #32a852, #28b66f);
      border-radius: 1.5rem 1.5rem 0 0;
      position: fixed;
      bottom: 0;
      width: 100%;
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: white;
    }
    .dial {
      width: 180px;
      height: 180px;
      border-radius: 50%;
      background: linear-gradient(145deg, #e0f2e9, #b0e0c6);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 8px 8px 15px #a3cbb3, -8px -8px 15px #ffffff;
      margin: auto;
      position: relative;
    }
    .dial-inner {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      background: #f0fff4;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      box-shadow: inset 6px 6px 10px #c8e6d2, inset -6px -6px 10px #ffffff;
    }
body { font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", Inter, sans-serif; }
    .card { border-radius: 1.25rem; }
    .tab-active { background: linear-gradient(to right, #22c55e, #16a34a); color: white; }
.install-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  width: 60px;
  height: 60px;
  border: none;
  border-radius: 50%;
  background: linear-gradient(135deg, #00c853, #64dd17);
  color: white;
  font-size: 28px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  cursor: pointer;
  z-index: 9999;
  transition: transform 0.2s ease-in-out;
}
.install-btn:hover {
  transform: scale(1.1);
}
.hidden {
  display: none;
}
  </style>
<!-- ✅ Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- ✅ FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
</head>

</head>
  <body class="bg-gray-100 min-h-screen flex flex-col">

     <!-- ✅ Header -->
  <script type="module" src="assets/js/header.js"></script>
    
    
  <!-- ✅ Notifications List -->
 <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  // ✅ Your Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyDt86oFFa-h04TsfMWSFGe3UHw26WYoR-U",
    authDomain: "tamilgeoapp.firebaseapp.com",
    databaseURL: "https://tamilgeoapp-default-rtdb.firebaseio.com",
    projectId: "tamilgeoapp",
    storageBucket: "tamilgeoapp.appspot.com",
    messagingSenderId: "1092623024431",
    appId: "1:1092623024431:web:ea455dd68a9fcf480be1da"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const listEl = document.getElementById("notificationsList");
  const emptyState = document.getElementById("emptyState");

  // ✅ Category Icons + Colors
  const categories = {
    General: { icon: "fa-clipboard", color: "bg-gray-400" },
    Entertainment: { icon: "fa-film", color: "bg-purple-500" },
    Political: { icon: "fa-landmark", color: "bg-red-500" },
    Nature: { icon: "fa-leaf", color: "bg-green-500" },
    Technology: { icon: "fa-microchip", color: "bg-blue-500" },
    Health: { icon: "fa-heart-pulse", color: "bg-pink-500" },
    Shopping: { icon: "fa-cart-shopping", color: "bg-yellow-500" }
  };

  // ✅ Load Notifications
  function loadNotifications() {
    const notiRef = ref(db, "notifications");

    onValue(notiRef, (snapshot) => {
      if (!snapshot.exists()) {
        listEl.innerHTML = "";
        emptyState.classList.remove("hidden");
        return;
      }

      emptyState.classList.add("hidden");
      const data = snapshot.val();
      const items = Object.entries(data).reverse();

      listEl.innerHTML = items.map(([id, noti]) => {
        const cat = categories[noti.category] || categories.General;

        return `
          <div class="flex items-center space-x-3 p-3 rounded-xl bg-white shadow hover:bg-gray-50 cursor-pointer"
               onclick="handleClick('${id}', '${noti.link || ""}')">
            <div class="p-3 rounded-full ${cat.color} text-white">
              <i class="fa-solid ${cat.icon}"></i>
            </div>
            <div class="flex-1">
              <p class="text-gray-800 font-medium truncate">${noti.title}</p>
              <span class="text-xs text-gray-500">${noti.category}</span>
            </div>
          </div>
        `;
      }).join("");
    });
  }

  // ✅ Handle Notification Click
  window.handleClick = function(id, link) {
    const notiRef = ref(db, "notifications/" + id);

    if (link && link !== "") {
      window.open(link, "_blank");
    } else {
      // fetch full notification details
      onValue(notiRef, (snapshot) => {
        if (snapshot.exists()) {
          const noti = snapshot.val();
          document.getElementById("popupTitle").innerText = noti.title;
          document.getElementById("popupDesc").innerText = noti.description || "";
          const imgEl = document.getElementById("popupImg");
          if (noti.image) {
            imgEl.src = noti.image;
            imgEl.classList.remove("hidden");
          } else {
            imgEl.classList.add("hidden");
          }
          document.getElementById("popupModal").classList.remove("hidden");
        }
      }, { onlyOnce: true });
    }
  };

  // ✅ Close Modal
  document.getElementById("closeModal").addEventListener("click", () => {
    document.getElementById("popupModal").classList.add("hidden");
  });

  loadNotifications();
</script>

<!-- ✅ Bottom Navigation -->

<script type="module">
  import { initFooter } from './assets/js/footer.js';
  initFooter();
</script>       