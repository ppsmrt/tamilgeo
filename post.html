<!-- post.html --><!DOCTYPE html><html lang="ta">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TamilGeo Post</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>
  <header>TamilGeo</header>
  <div class="container" id="post-container">
    <!-- Post content will load here -->
  </div>  <div class="container">
    <div class="engagement">
      <span id="view-count">üëÅ Views: 0</span>
      <button onclick="likePost()" id="like-button">‚ù§Ô∏è Like (<span id="like-count">0</span>)</button>
    </div><div class="comments-section">
  <h3>Comments</h3>
  <div id="comments-list"></div>
  <textarea id="comment-input" placeholder="Write your comment..."></textarea>
  <button onclick="submitComment()">Submit Comment</button>
</div>

  </div>  <footer>
    Copyright ¬©Ô∏è TamilGeo
  </footer>  <script>
    const firebaseConfig = {
      apiKey: "YOUR-API-KEY",
      authDomain: "your-project.firebaseapp.com",
      databaseURL: "https://your-project.firebaseio.com",
      projectId: "your-project-id",
      storageBucket: "your-project.appspot.com",
      messagingSenderId: "xxxxxxxx",
      appId: "xxxxxxxxxxxx"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const currentPost = JSON.parse(localStorage.getItem("postData"));
    const postId = currentPost.id;

    function formatDate(dateString) {
      const date = new Date(dateString);
      const options = { day: 'numeric', month: 'long', year: 'numeric' };
      return date.toLocaleDateString('en-GB', options);
    }

    function loadPost() {
      const container = document.getElementById("post-container");
      let imageUrl = currentPost._embedded?.['wp:featuredmedia']?.[0]?.source_url;
      container.innerHTML = `
        <div class="post-full">
          ${imageUrl ? `<img src="${imageUrl}" alt="Featured" class="post-full-img" />` : ""}
          <h2>${currentPost.title.rendered}</h2>
          <div class="post-meta">${currentPost._embedded.author[0].name} | ${formatDate(currentPost.date)}</div>
          <div class="post-body">${currentPost.content.rendered}</div>
        </div>
      `;
    }

    function loadEngagement() {
      const postRef = db.ref("posts/" + postId);
      postRef.once("value", snapshot => {
        const data = snapshot.val() || {};
        const views = (data.views || 0) + 1;
        const likes = data.likes || 0;

        document.getElementById("view-count").innerText = `üëÅ Views: ${views}`;
        document.getElementById("like-count").innerText = likes;

        postRef.update({ views });
      });
    }

    function likePost() {
      const postRef = db.ref("posts/" + postId + "/likes");
      postRef.transaction(current => (current || 0) + 1).then(result => {
        document.getElementById("like-count").innerText = result.snapshot.val();
      });
    }

    function loadComments() {
      const commentsRef = db.ref("comments/" + postId);
      const list = document.getElementById("comments-list");
      list.innerHTML = "";
      commentsRef.on("child_added", snapshot => {
        const data = snapshot.val();
        const div = document.createElement("div");
        div.textContent = data.text;
        list.appendChild(div);
      });
    }

    function submitComment() {
      const text = document.getElementById("comment-input").value.trim();
      if (text) {
        db.ref("comments/" + postId).push({ text });
        document.getElementById("comment-input").value = "";
      }
    }

    loadPost();
    loadEngagement();
    loadComments();
  </script></body>
</html>